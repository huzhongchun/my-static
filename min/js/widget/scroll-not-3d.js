!function(t){var e=function(t){var e=function(){};this.settings=$.extend({id:"scroll-box",pullDownCallback:e,pullUpCallback:e,startPullDownCallback:e,startPullDownMaxLength:40},t),this.init()};e.prototype={constructor:e,init:function(){var t=this,e=this.settings;if(t.time={},t.pageXY={},t.speed=0,t.direction=null,t.parentHeight=0,!e.id||!$("#"+e.id))return console.log("id或dom为null!"),!1;t.dom=$("#"+e.id);var n=$(this.dom).parent();n.css("overflow","hidden"),t.addListener()},addListener:function(){var t=this,e=this.settings,n=t.pageXY;t.touchendFlag=!0;var a=$(t.dom);a.on("touchstart",function(e){t.time.startT=(new Date).getTime(),n.startX=e.touches[0].pageX,n.startY=e.touches[0].pageY;var a=t.getTranslateArray();n.currentX=parseInt(a[0]),n.currentY=parseInt(a[1]),t.stopMoveByCss(n.currentY),t.maxMove=t.getMaxMove()}),a.on("touchmove",function(o){o.preventDefault(),n.endX=o.touches[0].pageX,n.endY=o.touches[0].pageY,n.moveX=n.endX-n.startX,n.movedY=n.endY-n.startY,t.direction=n.movedY>0?"up":"down",n.targetX=n.currentX+n.movedX,n.targetY=n.currentY+n.movedY,n.currentY<="0"&&n.targetY>0&&t.touchendFlag&&(e.startPullDownCallback(),t.touchendFlag=!1),n.currentY<=e.startPullDownMaxLength&&n.targetY>e.startPullDownMaxLength&&t.maxMove>0?a.css("-webkit-transform","translate(0px, 40px)"):t.maxMove>0&&(n.targetY<-(t.maxMove+e.startPullDownMaxLength)?a.css("-webkit-transform","translate(0px, "+-(e.startPullDownMaxLength+t.maxMove)+"px)"):a.css("-webkit-transform","translate(0px, "+n.targetY+"px)"))}),a.on("touchend",function(){var a,o,s;t.touchendFlag=!0;var r=t.getTranslateArray();n.touchEndX=parseInt(r[0]),n.touchEndY=parseInt(r[1]),t.time.endT=(new Date).getTime(),t.time.moveingT=t.time.endT-t.time.startT,n.moveLen=n.touchEndY-n.currentY,t.speed=Math.abs(n.moveLen/t.time.moveingT),a=t.time.moveingT/200,o=500*t.speed,s="down"===t.direction?n.touchEndY-o:n.touchEndY+o,s>=e.startPullDownMaxLength&&(s=e.startPullDownMaxLength),s<-(t.maxMove+e.startPullDownMaxLength)&&(s=-(t.maxMove+e.startPullDownMaxLength)),t.moveByCss(a,s),t.monitor()})},getTranslateArray:function(){var e,n=$(this.dom),a=t.getComputedStyle(n[0])["-webkit-transform"].split(")")[0].split(", ");return e="none"===a[0]?["0","0","0"]:[a[12]||a[4],a[13]||a[5],"0"]},stopMoveByCss:function(t){var e=$(this.dom);e.css({"-webkit-transition":"-webkit-transform 0s ease-out 0s",transition:"-webkit-transform 0s ease-out 0s"}),e.css("-webkit-transform","translate(0px, "+t+"px)")},moveByCss:function(t,e){var n=(this.settings,$(this.dom));n.css({"-webkit-transition":"-webkit-transform "+t+"s cubic-bezier(0.333333,0.666667,0.66667,1) 0s",transition:"-webkit-transform "+t+"s cubic-bezier(0.333333,0.666667,0.66667,1) 0s"}),n.css("-webkit-transform","translate(0px, "+e+"px)")},offset:function(t){for(var e=0,n=0,a=t;a.offsetParent;)e+=a.offsetLeft,n+=a.offsetTop,a=a.offsetParent;return{left:e,top:n}},getMaxMove:function(){var t=this.settings,e=$("#"+t.id).height(),n=e-$(this.dom).parent().height();return 0>n&&(n=0),n},monitor:function(){var t,e=this,n=this.settings,a=$(this.dom),o=setInterval(function(){var s=e.getTranslateArray(),r=parseInt(s[1]);r>0&&(e.stopMoveByCss(r),e.moveByCss("0.5",0),t=function(){n.pullDownCallback(),a.off("webkitTransitionEnd")},t(),clearInterval(o)),r<-e.maxMove&&(e.stopMoveByCss(r),e.moveByCss("0.5",-e.maxMove),t=function(){n.pullUpCallback(),a.off("webkitTransitionEnd")},t(),clearInterval(o))},100)}},F.addWidget("scrollObject",e)}(window);