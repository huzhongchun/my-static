!function(t){var e=function(t){this.settings=$.extend({type:1,pageShow:function(){},pageHide:function(){},useShakeDevice:{speed:30,callback:function(){}},useParallax:!0,useArrow:!0,useAnimation:!0,useMusic:{autoPlay:!0,loopPlay:!0,src:"http://mat1.gtimg.com/news/2015/love/FadeAway.mp3"},dragThreshold:.15,passedNoAnimate:!1},t),this.init()};e.prototype={constructor:e,currentItem:null,percentage:null,dragStart:null,page:{},animateType:{1:{upDrag:function(t,e){var a=1-.7*t;e.next().css("-webkit-transform","translate3d(0,"+100*a+"%,0)")},downDrag:function(t,e){var a=-(.7*t);e.prev().css("-webkit-transform","translate3d(0,"+(100*a-100)+"%,0)"),e.css("-webkit-transform","translate3d(0,"+100*a+"%,0)")},nextSlide:function(t){t.css("-webkit-transform","translate3d(0,-100%,0)"),t.next().css("-webkit-transform","translate3d(0,0,0)")},prevSlide:function(t){t.prev().css("-webkit-transform","scale(1)"),t.css("-webkit-transform","translate3d(0,100%,0)")},showSlide:function(t){t.css("-webkit-transform","scale(1)"),t.next().css("-webkit-transform","translate3d(0,100%,0)")}},2:{upDrag:function(t,e){var a=1-.2*t,n=1-.7*t;e.css("-webkit-transform","scale("+a+")"),e.next().css("-webkit-transform","translate3d(0,"+100*n+"%,0)")},downDrag:function(t,e){var a=.8-.2*t,n=-(.7*t);e.css("-webkit-transform","translate3d(0,"+100*n+"%,0)"),e.prev().css("-webkit-transform","scale("+a+")")},nextSlide:function(t){t.css("-webkit-transform","scale(.8)"),t.next().css("-webkit-transform","translate3d(0,0,0)")},prevSlide:function(t){t.prev().css("-webkit-transform","scale(1)"),t.css("-webkit-transform","translate3d(0,100%,0)")},showSlide:function(t){t.css("-webkit-transform","scale(1)"),t.next().css("-webkit-transform","translate3d(0,100%,0)")}},3:{upDrag:function(t,e){var a=1-.4*t;e.css("-webkit-transform","translate3d(0,"+(100*a-100)+"%,0)"),e.next().css("-webkit-transform","translate3d(0,"+100*a+"%,0)")},downDrag:function(t,e){var a=-(.4*t);e.prev().css("-webkit-transform","translate3d(0,"+(100*a-100)+"%,0)"),e.css("-webkit-transform","translate3d(0,"+100*a+"%,0)")},nextSlide:function(t){t.css("-webkit-transform","translate3d(0,-100%,0)"),t.next().css("-webkit-transform","translate3d(0,0,0)")},prevSlide:function(t){t.prev().css("-webkit-transform","scale(1)"),t.css("-webkit-transform","translate3d(0,100%,0)")},showSlide:function(t){t.css("-webkit-transform","scale(1)"),t.next().css("-webkit-transform","translate3d(0,100%,0)")}},4:{upDrag:function(t,e){var a=1-.4*t;e.css("-webkit-transform","translate3d(0,"+(100*a-100)+"%,0)"),e.next().css("-webkit-transform","translate3d(0,"+100*a+"%,0)")},downDrag:function(t,e){var a=-(.4*t);e.prev().css("-webkit-transform","translate3d(0,"+(100*a-100)+"%,0)"),e.css("-webkit-transform","translate3d(0,"+100*a+"%,0)")},nextSlide:function(t){t.addClass("zindex"),setTimeout(function(){t.removeClass("no-animation").css("-webkit-transform","translate3d(0,-100%,0)"),t.next().removeClass("zindex").addClass("no-animation").css("-webkit-transform","translate3d(0,0,0)")},100)},prevSlide:function(t){t.prev().css("-webkit-transform","translate3d(0,0,0)"),t.next().css("-webkit-transform","translate3d(0,100%,0)"),t.removeClass("zindex")},showSlide:function(t){t.css("-webkit-transform","scale(1)"),t.next().css("-webkit-transform","translate3d(0,100%,0)")}}},init:function(){this.initDom(),this.initEvent(),this.addEventListenFunc()},initDom:function(){var t=this,e=this.settings;if($("#scale-wrapper").addClass("H5FullscreenPage"),t.currentItem=$(".H5FullscreenPage-wrap .item").first(),t.currentItem.attr("state","next"),e.useAnimation){var a=$(".H5FullscreenPage-wrap .item");a.find(".part").addClass("hide"),t.orderPartFunc(a.first())}if($("body").append('<div class="overlay"></div>'),e.useArrow&&$(".item").slice(0,$(".item").length-1).append('<span class="arrow"></span>'),e.useMusic){var n=e.useMusic.autoPlay?'autoplay="autoplay"':"",s=e.useMusic.loopPlay?'loop="loop"':"",r=e.useMusic.src;$("body").append('<span class="music play"><audio id="audio" src='+r+" "+n+" "+s+"></audio></span>")}},initEvent:function(){var e=this,a=this.settings;if(a.useParallax){var n={x:0,y:0};t.addEventListener("deviceorientation",function(e){var a=e.gamma,s=e.beta,r=-a,i=-s;if(Math.abs(Math.abs(r)-Math.abs(n.x))<.1||Math.abs(Math.abs(i)-Math.abs(n.y))<.1)return n.x=r,void(n.y=i);n.x=r,n.y=i;var o=t.innerWidth/2,c=t.innerHeight/2,l=5,d=$(".parallax");d.forEach(function(t){var e=t.getBoundingClientRect().width/l*(r/o),a=t.getBoundingClientRect().width/l*(i/c);$(t).hasClass("item")?(e=-e/1+50,a=-a/1+50,t.style["background-position"]=""+e+"% "+a+"%"):t.style.transform=t.style["-webkit-transform"]="translate3d("+e+"px,"+a+"px,0)"})},!1)}if(a.useShakeDevice&&a.useShakeDevice.speed){var s=0,r=0,i=0,o=0,c=0,l=0;t.DeviceMotionEvent&&t.addEventListener("devicemotion",function(){var t=event.accelerationIncludingGravity;s=t.x,r=t.y,i=t.z,(Math.abs(s-o)>a.useShakeDevicespeed||Math.abs(r-c)>a.useShakeDevicespeed||Math.abs(i-l)>a.useShakeDevicespeed)&&a.useShakeDevice.callback&&a.useShakeDevice.callback(e.currentItem),o=s,c=r,l=i},!1)}},addEventListenFunc:function(){var e=this,a=this.settings;$(".music").on("tap",function(){$(this).toggleClass("play");var t=document.getElementById("audio");t.paused?t.play():t.pause()});var n=function(t){if(null===e.dragStart){var a=$(t.target).closest(".item");if(!a.length)return void $(".overlay").hide();t.touches&&(t=t.touches[0]),e.dragStart=t.clientY,a.addClass("no-animation"),a.next().addClass("no-animation"),a.prev().addClass("no-animation")}},s=function(n){if(n.preventDefault(),null!==e.dragStart){var s=$(n.target).closest(".item");if(!s.length)return void $(".overlay").hide();if(n.touches&&(n=n.touches[0]),e.percentage=(e.dragStart-n.clientY)/t.screen.height,e.percentage>0){{1-.5*e.percentage}e.animateType[a.type].upDrag(e.percentage,s)}else s.prev()&&e.animateType[a.type].downDrag(e.percentage,s)}},r=function(t){e.dragStart=null;var n=$(t.target).closest(".item");return n.length?(n.removeClass("no-animation"),n.next().removeClass("no-animation"),n.prev().removeClass("no-animation"),e.percentage>=a.dragThreshold?e.nextSlideFunc(n):Math.abs(e.percentage)>=a.dragThreshold?e.prevSlideFunc(n):e.showSlideFunc(n),void(e.percentage=0)):void $(".overlay").hide()};a.type>4?(a.type=a.type-4,$(".H5FullscreenPage-wrap .item").on({swipeUp:e.swipeUpFunc,swipeDown:e.swipeDownFunc})):$(".H5FullscreenPage-wrap .item").on({touchstart:n,touchmove:s,touchend:r,touchcancel:r}),$(".H5FullscreenPage-wrap .item").on("tap",function(){$(".overlay").hide()}),$(".H5FullscreenPage-wrap .item").on("transitionend",function(t){$(".overlay").hide(),"next"==$(t.target).attr("state")?a.pageShow(t.target):a.pageHide(t.target)}),$(".overlay").on("tap",function(){$(".overlay").hide()})},swipeUpFunc:function(t){var e=this,a=(this.settings,$(t.target).closest(".item"));a.length&&e.nextSlideFunc(a)},swipeDownFunc:function(t){var e=this,a=(this.settings,$(t.target).closest(".item"));a.length&&e.prevSlideFunc(a)},nextSlideFunc:function(t){var e=this,a=this.settings;t.next().length?(a.passedNoAnimate?null:$(".part").addClass("hide"),t.attr("state","prev"),t.siblings(".item").removeAttr("state"),e.currentItem=t.next(),e.currentItem.attr("state","next"),e.orderPartFunc(t.next()),e.animateType[a.type].nextSlide(t)):e.animateType[a.type].showSlide(t),e.orderPartFunc(e.currentItem)},prevSlideFunc:function(t){var e=this,a=this.settings;t.prev().length?(a.passedNoAnimate?null:$(".part").addClass("hide"),t.attr("state","prev"),t.siblings(".item").removeAttr("state"),e.currentItem=t.prev(),e.currentItem.attr("state","next"),e.animateType[a.type].prevSlide(t)):e.animateType[a.type].showSlide(t),e.orderPartFunc(e.currentItem)},showSlideFunc:function(t){var e=this,a=this.settings;e.animateType[a.type].showSlide(t)},orderPartFunc:function(t){var e=$(t).find(".part");e.forEach(function(t){var e=$(t).attr("data-delay")||100;setTimeout(function(){$(t).removeClass("hide")},e)})}},F.addWidget("H5FullscreenPageObject",e)}(window);